<!-- Pricing Section -->
<section class="pricing" id="enroll">
  <div class="container-pricing">
    <div class="section-header-center">
      <!-- Dynamic badge with active coupon -->
      <div class="badge-glow" *ngIf="activeCoupon">
        <lucide-icon [img]="Tag" class="badge-icon"></lucide-icon>
        <span>{{ discountBadgeText }} - {{ activeCoupon.code }}</span>
      </div>

      <!-- Default badge when no coupon -->
      <div class="badge-glow" *ngIf="!activeCoupon && !isCheckingCoupon">
        <lucide-icon [img]="Sparkles" class="badge-icon"></lucide-icon>
        <span>Limited Time Offer</span>
      </div>

      <h2 class="section-title-lg">
        Transform Your Trading <span class="gradient-text">Today</span>
      </h2>
      <p class="section-description">
        Join 6,000+ successful students. Lifetime access. One-time payment.
      </p>
    </div>

    <!-- Centered Price Card -->
    <div class="pricing-centered">
      <!-- Price Card -->
      <div class="pricing-price-card glass-card">
        <div class="pricing-glow"></div>

        <h3 class="pricing-plan-title">Complete Forex Mastery</h3>

        <!-- Price Comparison -->
        <div class="price-comparison">
          <div class="comparison-item">
            <span class="comparison-label">What Others Charge</span>
            <span class="comparison-price others">$499</span>
          </div>
          <div class="comparison-divider">
            <lucide-icon [img]="ArrowRight" class="comparison-arrow"></lucide-icon>
          </div>
          <div class="comparison-item">
            <span class="comparison-label">What We Charge</span>
            <span class="comparison-price ours">${{ originalPrice }}</span>
          </div>
        </div>

        <div class="price-display">
          <!-- WITH COUPON: Show final price -->
          <div *ngIf="activeCoupon">
            <div class="price-label">You Only Pay</div>
            <div class="price-current">
              <span class="currency">$</span>
              <span class="amount">{{ Math.floor(finalPrice) }}</span>
              <span class="period">.{{ ((finalPrice % 1) * 100).toFixed(0).padStart(2, '0') }}</span>
            </div>
            <p class="price-subtitle">One payment. Own it forever. No subscriptions.</p>
          </div>

          <!-- WITHOUT COUPON: Show $149 -->
          <div *ngIf="!activeCoupon">
            <div class="price-label">You Only Pay</div>
            <div class="price-current">
              <span class="currency">$</span>
              <span class="amount">{{ originalPrice }}</span>
              <span class="period">.00</span>
            </div>
            <p class="price-subtitle">One payment. Own it forever. No subscriptions.</p>
          </div>
        </div>

        <!-- Show "Start Learning" button if user is enrolled -->
        <div *ngIf="isUserEnrolled && !isCheckingEnrollment">
          <div class="enrollment-status">
            <lucide-icon [img]="CheckCircle" class="enrollment-icon"></lucide-icon>
            <span>You're already enrolled! ðŸŽ‰</span>
          </div>
          <button class="btn-enroll-epic btn-enrolled" routerLink="/dashboard/courses">
            <span>Start Learning</span>
            <lucide-icon [img]="ArrowRight" class="btn-icon-epic"></lucide-icon>
          </button>
        </div>

        <!-- Show "Enroll Now" button if user is NOT enrolled -->
        <a *ngIf="!isUserEnrolled && !isCheckingEnrollment" class="btn-enroll-epic" href="/checkout" target="_blank"
          rel="noopener">
          <span *ngIf="activeCoupon">Enroll Now - Save ${{ totalSavings.toFixed(2) }}</span>
          <span *ngIf="!activeCoupon">Enroll Now</span>
          <lucide-icon [img]="ArrowRight" class="btn-icon-epic"></lucide-icon>
        </a>

        <div class="trust-signals">
          <div class="trust-item">
            <lucide-icon [img]="Shield" class="trust-icon-sm"></lucide-icon>
            <span>30-Day Guarantee</span>
          </div>
          <div class="trust-item">
            <lucide-icon [img]="Lock" class="trust-icon-sm"></lucide-icon>
            <span>Secure Payment</span>
          </div>
          <div class="trust-item">
            <lucide-icon [img]="Zap" class="trust-icon-sm"></lucide-icon>
            <span>Instant Access</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Money-Back Guarantee -->
    <div class="money-back-guarantee">
      <div class="guarantee-badge">
        <lucide-icon [img]="ShieldCheck" class="guarantee-icon"></lucide-icon>
      </div>
      <div class="guarantee-content">
        <h4>100% Risk-Free 30-Day Money-Back Guarantee</h4>
        <p>Try the course for 30 days. If you're not completely satisfied, get a full refund. No questions
          asked.</p>
      </div>
    </div>

    <!-- Enrollment Process -->
    <div class="enrollment-process-wrapper">
      <h4 class="enrollment-heading">What Happens After Payment?</h4>
      <div class="enrollment-process">
        <div class="process-step">
          <div class="process-icon">
            <lucide-icon [img]="CreditCard" class="step-icon"></lucide-icon>
          </div>
          <div class="process-content">
            <h5 class="process-title">1. Complete Purchase</h5>
            <p class="process-text">Secure checkout in 2 minutes</p>
          </div>
        </div>
        <div class="process-arrow">
          <lucide-icon [img]="ArrowRight" class="arrow-icon"></lucide-icon>
        </div>
        <div class="process-step">
          <div class="process-icon">
            <lucide-icon [img]="Mail" class="step-icon"></lucide-icon>
          </div>
          <div class="process-content">
            <h5 class="process-title">2. Get Instant Access</h5>
            <p class="process-text">Confirmation sent to your email</p>
          </div>
        </div>
        <div class="process-arrow">
          <lucide-icon [img]="ArrowRight" class="arrow-icon"></lucide-icon>
        </div>
        <div class="process-step">
          <div class="process-icon">
            <lucide-icon [img]="GraduationCap" class="step-icon"></lucide-icon>
          </div>
          <div class="process-content">
            <h5 class="process-title">3. Start Learning</h5>
            <p class="process-text">Start the Beginners Class</p>
          </div>
        </div>
      </div>
    </div>

    <!-- FAQ Accordion (Below Bento Grid) -->
    <div class="faq-section-standalone">
      <h4 class="faq-heading">Frequently Asked Questions</h4>
      <div class="faq-accordion">
        <div class="faq-item" *ngFor="let faq of faqs; let i = index" [class.active]="faq.isOpen">
          <button class="faq-question" (click)="toggleFaq(i)">
            <span>{{ faq.question }}</span>
            <lucide-icon [img]="faq.isOpen ? Minus : Plus" class="faq-icon"></lucide-icon>
          </button>
          <div class="faq-answer" *ngIf="faq.isOpen">
            <p>{{ faq.answer }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>